import React from 'react';
import styled, { css } from 'styled-components';
import background from 'assets/background.svg';
import Heading from 'components/atoms/Heading/Heading';
import Button from 'components/atoms/Button/Button';
import ModelGSM from 'components/organisms/ModelGSM/ModelGSM';
import { Link, Element } from 'react-scroll';
import ItemModal from 'components/organisms/ItemModal/ItemModal';
import API from '../utils/API';
import Search from 'components/molecules/Search/Search';
const StyledWrapper = styled.div`
  background-image: url(${background});
  background-repeat: no-repeat;
  background-position: 50% 50%;
  height: 100vh;
  background-size: cover;
  position: relative;
`;

const StyledHeading = styled(Heading)`
  font-size: 6.3rem;
  color: white;
  position: absolute;
  top: 40%;
  margin-left: 10rem;

  @media (min-width: 310px) and (max-width: 430px) {
    font-size: 4.3rem;
    top: 20%;
    margin-left: 4rem;
  }
`;

const StyledButton = styled(Button)`
  position: absolute;
  top: 85%;
  left: 50%;
  margin-right: -50%;
  transform: translate(-50%, -50%);
`;

const ModelWrapper = styled(Element)`
  height: 100vh;
  width: 100vw;
  background-repeat: no-repeat;
  margin: 1rem 0 0 0;
  ${({ styledBackground }) =>
    styledBackground &&
    css`
      -webkit-filter: blur(3px);
      -moz-filter: blur(3px);
      -o-filter: blur(3px);
      -ms-filter: blur(3px);
      filter: blur(3px);
    `};
`;

const LegendWrapper = styled.div`
  position: absolute;
  width: 350px;
  background-color: white;
  z-index: 1;
  bottom: -100%;
  left: 3;
  border-radius: 30px;
  padding: 1rem;
  display: block;
`;

const StyledLine = styled.hr`
  width: 80px;
  height: 3px;
  background-color: ${({ color }) => color};
  margin-right: 2rem;
`;

const LegendItem = styled.div`
  display: inline-flex;
  margin: 0.7rem auto 0 auto;
  padding-left: 1rem;
`;
class Home extends React.Component {
  constructor(props) {
    super(props);
    this.state = {
      item: {
        shortcut: '',
        protocols: []
      },

      searchCSSItem: null
    };
  }

  checkItem = checkedItem => {
    this.setState({ item: checkedItem });
    checkedItem && this.getItem(checkedItem);
    this.setMobileScroll(200);
  };

  getItem = checkedItem => {
    API.post(`/interfaces/getByShortcut`, { shortcut: checkedItem }).then(
      res => {
        this.setState({ item: res.data });
      }
    );
  };

  updateSearch(event) {
    this.setState({ searchItem: event.target.value });
  }

  searchingFor(searchItem) {
    return function(x) {
      return x.toLowerCase().includes(searchItem.toLowerCase()) || !searchItem;
    };
  }

  setCSSSearchItem = item => {
    this.setState({ searchCSSItem: item });
    this.setMobileScroll(1);
  };

  setMobileScroll = delay => {
    window.screen.width < 500 &&
      setTimeout(() => {
        window.scrollTo(0, window.screen.height - 30);
      }, delay);
  };

  render() {
    const { item, searchCSSItem } = this.state;

    return (
      <>
        <StyledWrapper>
          <StyledHeading big>Model sieci komórkowej 2G/3G/4G</StyledHeading>
          <Link
            activeClass="active"
            to="model"
            spy={true}
            smooth={true}
            offset={0}
            duration={500}
          >
            <StyledButton>Zaczynajmy</StyledButton>
          </Link>
        </StyledWrapper>
        {item.id && <ItemModal item={item} isOpenModal={this.checkItem} />}
        <ModelWrapper id="model" styledBackground={item.name}>
          <Search
            setCheckedItem={this.checkItem}
            setCSSSearchItem={this.setCSSSearchItem}
          />
          {window.screen.width > 1000 && (
            <LegendWrapper>
              <LegendItem>
                <svg
                  width="139"
                  height="58"
                  viewBox="0 0 139 58"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M9.39696 37.6639C-0.764373 24.4159 16.8036 9.72527 48.6396 4.84127C80.4743 -0.0494003 114.517 6.73727 124.676 19.9813C134.84 33.2293 117.272 47.9266 85.437 52.8093C53.605 57.6946 19.5583 50.9066 9.39696 37.6639ZM4.15829 38.4653C15.6116 53.3973 53.0503 61.1853 87.777 55.8586C122.505 50.5346 141.373 34.1119 129.918 19.1813C118.465 4.24794 81.0303 -3.54273 46.2996 1.78527C11.5676 7.11593 -7.29771 23.5333 4.15829 38.4653Z"
                    fill="#00ADEF"
                  />
                  <path
                    d="M9.71457 37.0041C-0.446759 23.7561 17.1212 9.06541 48.9572 4.18141C80.7919 -0.709255 114.835 6.07741 124.993 19.3214C135.157 32.5694 117.589 47.2667 85.7546 52.1494C53.9226 57.0347 19.8759 50.2467 9.71457 37.0041Z"
                    fill="white"
                  />
                  <path
                    d="M39.5909 18.965L39.8176 20.6523L40.1954 19.1319L42.8295 10.2028H44.2533L46.6202 19.1319L46.954 20.6787L47.2463 18.9562L49.3334 10.2028H51.0297L47.7798 22.9989H46.2417L43.7124 13.6743L43.5214 12.6988L43.3081 13.6743L40.4673 22.9989H38.9292L35.9828 10.2028H37.6703L39.5909 18.965ZM59.7784 21.3379C59.355 21.9823 58.8045 22.4628 58.1271 22.7792H58.1358L57.6215 23.1746C56.9533 23.7078 56.6163 24.2263 56.6105 24.7302C56.6056 25.1521 56.8317 25.363 57.2887 25.363C57.57 25.363 57.8638 25.2868 58.1703 25.1345L58.2723 26.1979C57.8591 26.4557 57.3889 26.5846 56.8616 26.5846C56.3401 26.5846 55.9287 26.4322 55.6276 26.1276C55.3322 25.8229 55.1875 25.4186 55.1933 24.9148C55.2006 24.282 55.4944 23.702 56.0747 23.1746C54.7976 23.1512 53.7713 22.7176 52.9959 21.8739C52.2264 21.0244 51.8497 19.8995 51.8658 18.4992L51.8691 18.2092C51.88 17.2659 52.0684 16.4251 52.4343 15.6869C52.8062 14.9428 53.3167 14.3627 53.9661 13.9467C54.6213 13.5249 55.3269 13.314 56.0827 13.314C57.319 13.314 58.2753 13.7212 58.9515 14.5356C59.6276 15.35 59.957 16.5159 59.9395 18.0334L59.9317 18.7101H53.4893C53.502 19.6475 53.7657 20.4063 54.2805 20.9863C54.8012 21.5605 55.4659 21.8476 56.2745 21.8476C56.8487 21.8476 57.3364 21.7304 57.7375 21.496C58.1387 21.2617 58.4909 20.9512 58.7942 20.5645L59.7784 21.3379ZM56.0673 14.6498C55.4111 14.6498 54.8575 14.89 54.4067 15.3705C53.9559 15.8451 53.6728 16.513 53.5575 17.3742H58.3211L58.3225 17.2512C58.2852 16.4251 58.0699 15.7865 57.6766 15.3353C57.2835 14.8783 56.747 14.6498 56.0673 14.6498ZM63.3166 21.6718H68.88L68.8648 22.9989H61.315L61.3287 21.8036L66.656 14.8344H61.4881L61.5035 13.4897H68.7106L68.6973 14.641L63.3166 21.6718ZM74.5053 23.1746C73.2163 23.1746 72.1723 22.7528 71.3734 21.9091C70.5746 21.0595 70.1833 19.9258 70.1997 18.508L70.2031 18.2092C70.214 17.2659 70.4024 16.4251 70.7683 15.6869C71.1401 14.9428 71.6507 14.3627 72.3 13.9467C72.9553 13.5249 73.6608 13.314 74.4167 13.314C75.653 13.314 76.6093 13.7212 77.2855 14.5356C77.9616 15.35 78.291 16.5159 78.2735 18.0334L78.2657 18.7101H71.8233C71.836 19.6475 72.0997 20.4063 72.6145 20.9863C73.1352 21.5605 73.7999 21.8476 74.6085 21.8476C75.1827 21.8476 75.6704 21.7304 76.0715 21.496C76.4727 21.2617 76.8249 20.9512 77.1281 20.5645L78.1124 21.3379C77.3014 22.5624 76.0991 23.1746 74.5053 23.1746ZM74.4013 14.6498C73.7451 14.6498 73.1915 14.89 72.7407 15.3705C72.2899 15.8451 72.0068 16.513 71.8914 17.3742H76.6551L76.6565 17.2512C76.6192 16.4251 76.4039 15.7865 76.0106 15.3353C75.6174 14.8783 75.081 14.6498 74.4013 14.6498ZM82.1627 15.3617L83.5575 14.8256L83.5451 15.9066L82.1502 16.4427L82.0747 22.9989H80.44L80.5083 17.0666L79.2371 17.55L79.2495 16.469L80.5207 15.9857L80.5954 9.49977H82.2302L82.1627 15.3617ZM41.8542 41.4752C41.8592 41.0358 41.6962 40.6959 41.3649 40.4557C41.0396 40.2096 40.4649 39.9987 39.6408 39.823C38.8225 39.6472 38.1716 39.4363 37.6881 39.1902C37.2105 38.9441 36.8564 38.6512 36.626 38.3113C36.4014 37.9715 36.2917 37.5672 36.2971 37.0985C36.3061 36.3193 36.6418 35.6601 37.3043 35.1211C37.9726 34.5821 38.8195 34.3126 39.8448 34.3126C40.923 34.3126 41.7928 34.5909 42.4544 35.1475C43.1218 35.7041 43.4505 36.416 43.4405 37.2831H41.8058C41.8109 36.8378 41.6249 36.454 41.2477 36.1318C40.8764 35.8095 40.4037 35.6484 39.8295 35.6484C39.2377 35.6484 38.7733 35.7773 38.4363 36.0351C38.0994 36.2929 37.9285 36.6298 37.9237 37.0458C37.9192 37.4383 38.0711 37.7342 38.3793 37.9334C38.6876 38.1326 39.245 38.3231 40.0515 38.5047C40.8638 38.6863 41.5205 38.9031 42.0215 39.155C42.5225 39.407 42.8911 39.7116 43.1272 40.069C43.3692 40.4206 43.4873 40.8512 43.4815 41.3609C43.4717 42.2105 43.124 42.8931 42.4384 43.4087C41.7528 43.9184 40.868 44.1733 39.784 44.1733C39.0223 44.1733 38.3501 44.0385 37.7672 43.769C37.1844 43.4995 36.7287 43.1245 36.4003 42.6441C36.0778 42.1578 35.9197 41.6334 35.9262 41.0709H37.5522C37.5752 41.6158 37.787 42.0494 38.1876 42.3716C38.5941 42.688 39.1314 42.8462 39.7993 42.8462C40.4146 42.8462 40.9082 42.7232 41.2801 42.4771C41.658 42.2251 41.8494 41.8912 41.8542 41.4752ZM47.3359 43.9975H45.7099L45.8194 34.4883H47.4454L47.3359 43.9975ZM45.7166 31.9661C45.7196 31.7024 45.8013 31.4798 45.9616 31.2981C46.1277 31.1165 46.369 31.0257 46.6854 31.0257C47.0018 31.0257 47.241 31.1165 47.403 31.2981C47.565 31.4798 47.6444 31.7024 47.6414 31.9661C47.6384 32.2297 47.5538 32.4494 47.3877 32.6252C47.2216 32.801 46.9804 32.8888 46.664 32.8888C46.3476 32.8888 46.1083 32.801 45.9463 32.6252C45.7901 32.4494 45.7136 32.2297 45.7166 31.9661ZM53.8905 44.1733C52.6014 44.1733 51.5575 43.7514 50.7586 42.9077C49.9598 42.0582 49.5685 40.9244 49.5848 39.5066L49.5883 39.2078C49.5992 38.2645 49.7875 37.4237 50.1535 36.6855C50.5253 35.9414 51.0359 35.3613 51.6852 34.9453C52.3405 34.5235 53.046 34.3126 53.8019 34.3126C55.0382 34.3126 55.9945 34.7198 56.6706 35.5342C57.3468 36.3486 57.6761 37.5145 57.6587 39.032L57.6509 39.7087H51.2085C51.2211 40.6461 51.4849 41.4049 51.9997 41.9849C52.5204 42.5591 53.1851 42.8462 53.9937 42.8462C54.5679 42.8462 55.0556 42.729 55.4567 42.4947C55.8578 42.2603 56.21 41.9498 56.5133 41.5631L57.4976 42.3365C56.6866 43.561 55.4842 44.1733 53.8905 44.1733ZM53.7865 35.6484C53.1302 35.6484 52.5767 35.8886 52.1259 36.3691C51.6751 36.8437 51.392 37.5116 51.2766 38.3729H56.0403L56.0417 38.2498C56.0043 37.4237 55.789 36.7851 55.3958 36.3339C55.0026 35.8769 54.4662 35.6484 53.7865 35.6484ZM63.3189 42.8462C63.8989 42.8462 64.4078 42.6704 64.8454 42.3189C65.2831 41.9673 65.5284 41.5279 65.5813 41.0006H67.1194C67.0838 41.5455 66.8904 42.064 66.539 42.5562C66.1876 43.0483 65.7202 43.4409 65.1368 43.7338C64.5592 44.0268 63.9481 44.1733 63.3036 44.1733C62.0087 44.1733 60.9824 43.7426 60.2247 42.8813C59.473 42.0142 59.1057 40.8307 59.123 39.3308L59.1261 39.0584C59.1368 38.1326 59.3162 37.3094 59.6643 36.5888C60.0125 35.8681 60.5053 35.3086 61.1427 34.9102C61.7859 34.5118 62.5411 34.3126 63.4083 34.3126C64.4747 34.3126 65.3558 34.6319 66.0516 35.2705C66.7532 35.9092 67.1216 36.7382 67.1567 37.7577H65.6187C65.5789 37.1425 65.3503 36.6386 64.9329 36.246C64.5215 35.8476 64.0082 35.6484 63.3929 35.6484C62.5668 35.6484 61.9217 35.9472 61.4578 36.5449C60.9998 37.1366 60.7644 37.9949 60.7514 39.1199L60.7479 39.4275C60.7353 40.5231 60.9511 41.3668 61.3955 41.9586C61.8398 42.5503 62.481 42.8462 63.3189 42.8462ZM70.6796 43.9975H69.0536L69.1631 34.4883H70.7891L70.6796 43.9975ZM69.0603 31.9661C69.0634 31.7024 69.145 31.4798 69.3053 31.2981C69.4715 31.1165 69.7128 31.0257 70.0292 31.0257C70.3456 31.0257 70.5848 31.1165 70.7467 31.2981C70.9087 31.4798 70.9882 31.7024 70.9851 31.9661C70.9821 32.2297 70.8976 32.4494 70.7315 32.6252C70.5654 32.801 70.3241 32.8888 70.0077 32.8888C69.6913 32.8888 69.4521 32.801 69.2901 32.6252C69.1339 32.4494 69.0573 32.2297 69.0603 31.9661ZM72.9151 39.155C72.9258 38.2235 73.1171 37.3856 73.4889 36.6415C73.8666 35.8974 74.383 35.3233 75.0381 34.919C75.699 34.5147 76.4484 34.3126 77.2863 34.3126C78.5812 34.3126 79.6219 34.7608 80.4085 35.6572C81.2009 36.5536 81.5885 37.7459 81.5714 39.2341L81.5701 39.3484C81.5594 40.2741 81.3711 41.1061 81.0052 41.8443C80.6452 42.5767 80.1318 43.1479 79.465 43.5581C78.804 43.9682 78.0458 44.1733 77.1903 44.1733C75.9012 44.1733 74.8605 43.725 74.0681 42.8286C73.2815 41.9322 72.8968 40.7457 72.9138 39.2693L72.9151 39.155ZM74.5476 39.3484C74.5355 40.403 74.7689 41.2496 75.2479 41.8882C75.7327 42.5269 76.3853 42.8462 77.2056 42.8462C78.0317 42.8462 78.6917 42.5239 79.1855 41.8795C79.6793 41.2291 79.9329 40.321 79.9463 39.155C79.9583 38.1121 79.719 37.2684 79.2284 36.6239C78.7437 35.9736 78.0912 35.6484 77.2709 35.6484C76.4681 35.6484 75.817 35.9677 75.3175 36.6064C74.8179 37.245 74.5613 38.159 74.5476 39.3484ZM92.0013 41.7564L93.9131 34.4883H95.5391L92.6611 43.9975H91.3427L89.1142 36.7909L86.7812 43.9975H85.4628L82.8126 34.4883H84.4297L86.2198 41.607L88.5167 34.4883H89.8262L92.0013 41.7564ZM100.23 41.6158L102.526 34.4883H104.267L100.317 45.4652C99.707 47.0471 98.7575 47.838 97.4684 47.838L97.1611 47.8117L96.556 47.6974L96.5711 46.3792L97.0102 46.4143C97.561 46.4143 97.99 46.303 98.2972 46.0804C98.6104 45.8577 98.8699 45.4505 99.076 44.8588L99.4474 43.892L96.1631 34.4883H97.9385L100.23 41.6158Z"
                    fill="#231F20"
                  />
                </svg>
              </LegendItem>
              <LegendItem>
                <StyledLine color={'009BA0'} />
                Interfejs zewnętrzny
              </LegendItem>
              <LegendItem>
                <StyledLine color={'00ADEF'} />
                Interfejs wewnętrzny
              </LegendItem>
              <LegendItem>
                <StyledLine color={'C7372D'} />
                Interfejs do opcjonalnych <br />
                podsystemów usługowych
              </LegendItem>
              <LegendItem>
                <StyledLine color={'000000'} />
                Interfejs bezpośredniej <br />
                komunikacji z internetem
              </LegendItem>
            </LegendWrapper>
          )}
          <ModelGSM
            setCheckedItem={this.checkItem}
            setCSSSearchItem={searchCSSItem}
          />
        </ModelWrapper>
      </>
    );
  }
}

export default Home;
